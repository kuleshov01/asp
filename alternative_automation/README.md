# Альтернативная реализация автоматизации без Playwright

## Обзор

Этот проект представляет собой альтернативную реализацию автоматизации веб-задач, которая использует HTTP-запросы вместо браузерной автоматизации с помощью Playwright. Это позволяет:

- Работать в фоновом режиме без открытия браузера
- Быстрее выполнять операции
- Меньше потреблять системные ресурсы
- Лучше интегрироваться в серверные среды

## Архитектура

Проект состоит из следующих основных компонентов:

- `advanced_http_client.py` - основной клиент для HTTP-взаимодействия с веб-приложением
- `automation_functions.py` - функции автоматизации, заменяющие Playwright-функции
- `excel_handler.py` - функции для работы с Excel-файлами
- `new_login.py` - основной скрипт, использующий новую реализацию
- `test_automation.py` - тестовый скрипт для проверки функциональности

## Зависимости

- requests==2.31.0
- beautifulsoup4==4.12.2
- pandas==2.1.4
- openpyxl==3.1.2
- python-dateutil==2.8.2
- workalendar==16.0
- numpy==1.26.3
- python-dotenv==1.0
- httpx==0.25.2

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Создайте файл `.env` с вашими учетными данными:
```
LOGIN=ваш_логин
PASSWORD=ваш_пароль
```

3. Убедитесь, что файл Excel с данными находится в папке `data/` с названием `СПИСОК ДЕТЕЙ МИНСОЦ 2025.xlsx`

## Использование

Запустите основной скрипт:
```bash
python new_login.py
```

Для тестирования функциональности:
```bash
python test_automation.py
```

**Важное замечание**: Для полноценной работы скрипта необходимо:
1. Иметь доступ к веб-приложению по адресу `http://localhost/aspnetkp/`
2. Убедиться, что веб-приложение запущено и доступно
3. Проверить, что учетные данные в файле `.env` корректны

Если веб-приложение недоступно по умолчанию адресу, можно изменить базовый URL в файле `advanced_http_client.py`:
```python
class AdvancedWebAutomationClient:
    def __init__(self, base_url="http://ваш_адрес/aspnetkp/"):  # Измените на ваш адрес
        self.base_url = base_url
        # ...
```

## Преимущества новой реализации

1. **Фоновая работа** - не открывает браузер, работает полностью в фоновом режиме
2. **Высокая производительность** - прямые HTTP-запросы быстрее, чем браузерная автоматизация
3. **Меньшее потребление ресурсов** - не требуется запуск браузерного движка
4. **Лучшая стабильность** - не зависит от изменений в интерфейсе браузера
5. **Простота деплоя** - легче развертывать на серверах без GUI

## Особенности реализации

- Использует ASP.NET WebForms специфику (ViewState, EventValidation)
- Обрабатывает все необходимые HTTP-параметры для корректной работы с веб-приложением
- Сохраняет сессию между запросами
- Анализирует HTML-ответы для извлечения необходимых данных

## Тестирование

Тестовый скрипт проверяет:
- Наличие всех необходимых функций
- Обработку дат
- Обработку числовых данных
- Корректность основных методов клиента

## Заключение

Новая реализация полностью заменяет функциональность Playwright, обеспечивая более эффективную и стабильную автоматизацию веб-задач. Она особенно полезна для серверных сред и задач, требующих высокой производительности.